# 星星坠落

## 题目背景

![](https://s1.328888.xyz/2022/05/25/lC7VO.png)

碎星的传说

雕制关于英雄传说的护符。

能提升力气

被誉为最强的半神

独自挑战、粉碎坠落的星星。

据说从那之后，星星的命运就受到封印。

## 题目描述

​经过不"屑"的努力，你终于当上了艾尔登之王，常言道“要致富，先修路”，为了促进狭间之地的经济发展，你决定在狭间之地下令开辟运输通道。

​狭间之地可以认为是一棵树 $T$，树上有 $n$ 个结点；每个结点代表一座城市，编号从 $1$ 到 $n$；$1$号结点是“黄金树”所在的地方，也是整棵树的 $T$ 的根节点。对于树 $T$ 中的每一个结点 $u$，都有一个点权 $w_u$；令 $S_u$ 代表以 $u$ 为根节点的子树，$V_u$ 是以根节点的子树的权值，那么$V_u=\sum\limits_{i\in S_u} w_i$，其中 $i$ 是 $S_u$ 中的结点（包括 $u$）。

​由于开辟新的运输通道需要拉车的巨人、护卫的士兵，劳民伤财，因此你命令每个城市的负责人开辟一条通往比自己城市编号小的城市的运输通道。然而这些城市的负责人并不是特别听话，对于编号为 $v$ 的城市（$T$ 上的 $v$ 号结点），如果存在比他们编号小的城市 $u$，且两个城市非常**亲密**，则它会修建一条通往 $u$ 的运输通道。如果不存在这样的城市 $u$，那么城市 $v$ 会抗旨不开辟运输通道。

​$v$ 仅可能向比它编号小的城市修建至多一条运输通道。$u$ 到 $v$ 之间存在一条运输通道当且仅当：

* $u<v$；

* 两城市**亲密**，即 $S_u$ 和 $S_v$ 同构，即两棵树有一样的结构。$S_u$ 和 $S_v$ 同构即对于 $S_u$ 中的每个结点，将它们的子结点顺序任意交换之后可以得到一棵和 $S_v$ 形状完全相同的树（点权可以不相同）；

* 如果存在多个 $u$，满足以上两个条件，那么选择使 $|V_u-V_v|$ 最小的一个城市 $u$，如果仍然有多个城市满足条件，那就选择编号最小的一个。

根据以上条件，我们可以在树上建立若干条运输通道，令 $P_v$ 为城市 $v$ 负责开辟的运输通道，这条通道连接了城市 $u$ 和 $v$，那么 $V_{P_v}$ 为该运输通道的价值，且 $V_{P_v}=V_u+V_v$。

​为了避免冗余花费，从 $u$ 到 $v$ 的运输通道会选择树 $T$ 上从 $u$ 到 $v$ 的简单路径，路径上所有点仅访问一次，路径上起点和终点分别是 $u$ 和 $v$。

​你组织了解脱碎星将军的盛宴，碎星将军的陨落导致了流星的坠落，其中一颗流星砸在了狭间之地并摧毁了树上的一个结点。结点的摧毁导致某些运输通道被破坏，假设被摧毁的结点是 $u$，那么包含结点 $u$ 的所有运输道路都会被摧毁，你的国度总的损失就是 $\sum\limits_{P_v\ni u} V_{P_v}$。

​你被告知一个运输通道 $P_v$ 被摧毁了，但是你不知道具体是哪个结点被摧毁，你希望能计算出 $P_v$ 被摧毁以后**必然造成的损失**。**必然造成的损失**指：不论 $P_v$ 上的哪一个结点被摧毁，都必然被破坏的运输通道的价值和。换句话说，我们将 $P_v$ 描述为 $[v_1,v_2,...,v_m]$，即位于 $P_v$ 上的结点形成的一个列表；对于每一个 $v_i$ 求得路径上包含 $v_i$ 的运输通道集合 $A_i$，那么我们就可以得到一系列运输通道 $[A_1,A_2,...,A_m]$，取所有集合的交集 $\bigcap\limits_{i=1}^m A_i$ 就是必然被破坏的运输通道集合，所得集合中所有运输通道的损失和即为**必然造成的损失**。

由于你现在不知道哪个运输通道被破坏了，所以假设得到每一个运输通道被破坏的消息的概率相等，你希望求出**必然造成的损失**的期望。

## 输入格式

第一行包括一个整数 $n$，代表树 $T$ 结点的数量。

第二行包含 $n-1$ 个整数，第 $i$ 个整数代表结点 $i+1$ 的父亲结点。

第三行包含 $n$ 个整数，第 $i$ 个整数 $w_i$ 代表结点 $i$ 的点权。

## 输出格式

你等概率得知某一个运输通道被破坏，所计算出的**必然造成的损失**的期望为 $\frac{P}{Q}$；输出仅包含一个整数 $P\cdot Q^{-1}\bmod 998244353$。

## 示例1

### 输入

```
3
1 1
2 2 2
```

### 输出

```
4
```

### 说明

![tonyi.png](https://s1.328888.xyz/2022/05/29/tonyi.png)

图中仅有 $S_2$ 和 $S_3$ 同构，因此只存在一条路径 $2-3$，其摧毁后的必然产生损失 $4$，所以结果为 $4$。

## 示例2

### 输入

```
11
1 2 3 3 2 6 6 1 9 9
3 4 9 1 5 3 7 6 5 2 2
```

### 输出

```
285212689
```

### 说明

![toZAF.png](https://s1.328888.xyz/2022/05/29/toZAF.png)

该样例中存在的路径有 $[4-5,3-6,5-7,5-8,3-9,4-10,10-11]$，其被摧毁后造成的必然代价分别为 $[6,54,12,11,27,3,4]$，和为 $117$，除以路径数 $7$ 后的逆元表示为 $285212689
$。

## 提示

$n\le 100000$

$1\le w_i\le 100000$