# 泥头车Plus（SPJ by ZTZ）

## 题目背景

![image-20220520010642415](https://s1.328888.xyz/2022/05/22/dRd1T.png)

落叶捎来讯息，在雾的彼端，我们的故乡交界地，褪色者击败了狗薪王走上了癫火的道路，相比人们会如此形容——别在这儿发癫。

## 题目描述

该题目是《泥头车》的升级版，建议先看《泥头车》，方便理解该题目。

​你设计的二维迷宫太简单辣！泥头车马上就追上你给你创死死。因为地皮比较贵，你无法继续扩张你的二维迷宫，但是你另辟蹊径，开始向下扩展，将你的二维迷宫改造成了三维迷宫。

​现在，你的地下墓地可以认为是一个 $n\times n\times n$ 的三维空间，$(x,y,z)$ 表示棋盘中第 $z$ 层第 $y$ 行第 $x$ 列的格子。空间的起点在 $(1,1,1)$ 的格子里，终点在 $(n,1,1)$ 的格子里。一开始，所有格子都是不互通的，可以认为每一个格子是一个小房间，六面都是墙壁，你可以打通网格中的任意墙壁（不包括边缘的墙壁），形成一个迷宫；你将会躲在终点的位置，而泥头车会从起点开始找你。

你所构造的迷宫必须满足以下要求。

* 这是一个迷宫，而不是你的棺材，所以你必须保证你所躲藏的**终点和起点是连通的**。
* 泥头车有极高的人工智能（挂），可以直接找到地图中的最近路径来找你，因此，为了延长苟延残喘的时间，你必须让迷宫具有**尽可能多的转弯**。

​泥头车在1个单位时间内可以进行两个动作其中之一。

* 转弯：更改自己的朝向，更改前后的朝向均平行于 $x$ 轴、 $y$ 轴或 $z$ 轴。

* 冲撞：朝着自己当前的朝向移动任意距离，但是不能穿过未打通的墙壁。

初始时刻，泥头车的朝向必然是创死你的最短路径第一次冲撞的方向，且泥头车绝顶聪明，即泥头车的操作总是“冲撞、转弯、冲撞、转弯、冲撞”交替，并且第一次和最后一次操作必然是冲撞。

换句话说，在一个三维空间内，你可以做若干次如下动作：U、D、L、R、B、A。分别表示从 $(x,y,z)$ 移动到 $(x,y+1,z),(x,y-1,z),(x-1,y,z),(x+1,y,z),(x,y,z+1),(x,y,z-1)$。给定空间立方体的边长 $n$，在行动过程中你必须保证 $1\le x,y,z\le n$，每个位置只能访问一次。每个操作产生 $1$ 的代价当且仅当该操作不同于上一个操作（第一个操作认为必然产生代价），请你规划一条从 $(1,1,1)$ 到 $(n,1,1)$ 的行动路线，使得产生的代价最大。

## 输入格式

一个整数 $m$，代表 $n=2^m$，$n$ 为空间的边长。

## 输出格式

第一行包含一个数字，表示你最晚的死亡时间，这个数字可能很大，你需要对其取模 $998244353$。

如果 $m\le 5$，那么你还需要输出 $1$ 行字符串，字符串包括至多 $n^3-1$ 个字符，表示行动路线。在 $m>5$ 的情况下只需要输出第一行的死亡时间即可。

由于泥头车总是按照最短路径前进，你无需在构造的迷宫最短路径上添加别的分支，因此你可以用U、D、L、R、B、A唯一描述出你构造的迷宫。其中，U，D，L，R，B，A分别代表从 $(x,y,z)$ 移动到 $(x,y+1,z),(x,y-1,z),(x-1,y,z),(x+1,y,z),(x,y,z+1),(x,y,z-1)$。

请保证你构造的迷宫路线永远在 $n\times n\times n$ 空间内，路线自身没有交叉或分支，且是从起点连通到终点的。若存在多种方案，输出任意一种。

## 示例1

### 输入

```
1
```

### 输出

```
13
URBLDRA
```

### 说明

泥头车经过了7次冲撞和6次转弯，共消耗13单位时间。可以参照如下图像进行理解

![](https://s1.328888.xyz/2022/05/24/lunDg.png)

## 示例2

### 输入

```
200
```

### 输出

```
581750452
```

### 说明

太难了！

## 备注

$1\le m\le 1000000$