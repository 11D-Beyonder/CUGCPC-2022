# 泥头车

## 题目背景

![泥头车](https://s1.328888.xyz/2022/05/22/dRd1T.png)

落叶捎来讯息，在雾的彼端，我们的故乡交界地，褪色者击败了狗薪王走上了癫火的道路，相比人们会如此形容——别在这儿发癫。

## 题目描述

通过“接肢”的秘术，你成功打败了狗薪王，却受到三指的蛊惑，走上了癫火的道路。为了自己的使命，梅琳娜派出了最强杀器泥头车来追杀你，即使你同样派出了你麾下的最强战力——铁球应战，也依然不敌。

​泥头车马上就要碾碎铁球来追杀你了，为了自己的安全，你将为自己打造一个地下墓地，通过错综复杂的道路来延缓泥头车追杀你的速度。众所周知，泥头车直线冲撞速度非常快，但是转弯速度很慢，因此，你需要让迷宫有更多的转弯来减缓泥头车的速度。

​地下墓地可以认为是一个 $n\times n$ 的棋盘，$(x,y)$ 表示棋盘中第 $y$ 行第 $x$ 列的**格子**，起点在左下角 $(1,1)$ 的格子里，终点在右下角 $(n,1)$。一开始，所有格子都是不互通的，可以认为每一个格子是一个小房间，四面都是墙壁，你可以打通网格中的任意墙壁（不包括棋盘边缘的墙壁），形成一个迷宫。你将会躲在终点的位置，而泥头车会从起点开始找你。

你所构造的迷宫必须满足以下要求。

* 这是一个迷宫，而不是你的棺材，所以你必须保证你所躲藏的**终点和起点是连通的**。

* 泥头车有极高的人工智能（挂），可以直接找到地图中的最近路径来找你，因此，为了延长苟延残喘的时间，你必须让迷宫具有**尽可能多的转弯**。

​泥头车在 $1$ 个单位时间内可以进行两个动作其中之一。

* 转弯：更改自己前进的朝向，更改前后的朝向均平行于 $x$ 轴或 $y$ 轴。

* 冲撞：朝着自己当前的朝向移动任意距离，但是不能穿过未打通的墙壁。

​初始时刻，泥头车的朝向必然是创死你的最短路径上第一次冲撞的方向，且泥头车绝顶聪明，即泥头车的动作总是“冲撞、转弯、冲撞、转弯、冲撞”这样交替，并且第一次和最后一次动作必然是冲撞。

![](https://s1.328888.xyz/2022/05/29/tZ7SS.png)

如图，这是一个 $4\times 4$ 的棋盘，你可以按红色线路设计，打通红线穿过的 $17$ 堵墙壁，形成红色线这样的迷宫，那么泥头车会按下图的绿色线路行进。

![image-20220520021013566](https://s1.328888.xyz/2022/05/29/tZsmA.png)

可以看到，泥头车会经过六次冲撞和五次转弯，共花费 $11$ 的时间，所以你被泥头车创死的最晚时间就是 $11$。

​换句话说，在一个二维平面内，你可以做若干次如下动作：U、D、L、R。分别表示从 $(x,y)$ 移动到 $(x,y+1),(x,y-1),(x-1,y),(x+1,y)$。给定棋盘大小 $n$，在操作过程中你必须保证 $1\le x,y\le n$，每个位置只能访问一次。每个动作产生 $1$ 的代价当且仅当动作不同于上一个动作（第一个动作认为必然产生代价），请你规划一条从 $(1,1)$ 到 $(n,1)$ 的行动路线，使得产生的代价最大。

## 输入格式

一个整数 $m$，代表 $n=2^m$，$n$ 为棋盘的边长。

## 输出格式

第一行包含一个数字，表示你最晚的死亡时间，这个数字可能很大，你需要对其取模 $998244353$。

如果 $m\le 10$，那么你还需要输出 $1$ 行字符串，字符串至多有 $n^2-1$ 个字符，表示迷宫的构造。在 $m>10$ 的情况下只需要输出第一行的死亡时间即可。

由于泥头车总是按照最短路径前进，你无需在构造的迷宫最短路径上添加别的分支，因此你可以用U、D、L、R唯一描述出你构造的迷宫。其中，U、D、L、R 分别代表从 $(x,y)$ 移动到 $(x,y+1)$、$(x,y-1)$、$(x-1,y)$、$(x+1,y)$。

请保证你构造的迷宫路线永远在 $n\times n$ 棋盘内，路线自身没有交叉和分支，且是从起点连通到终点的。若存在多种方案，输出任意一种。

## 示例1

### 输入

```
1
```

### 输出

```
5
URD
```

### 说明

一共可以有三次冲撞两次转弯，所以最长的存活时间为5。

## 示例2

### 输入

```
200
```

### 输出

```
123315454
```

### 说明

因为输入大于10，所以只输出最长存活时间即可。

## 提示

$1\le m\le 1000000$