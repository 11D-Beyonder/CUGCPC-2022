# A 365里路

## 题目背景

![5HJOi.png](https://s1.328888.xyz/2022/05/30/5HJOi.png)

三百六十五里路呀

越过春夏秋冬

三百六十五里路呀

岂能让它虚度

三百六十五里路呀

从故乡到异乡

三百六十五里路呀

从少年到白头

## 题目描述

黑暗之魂凭借着前无古人后无来者的地图设计，将宫崎老贼推上了神坛。在玩家抵达王城取得王器（**前方有巨大宝箱**）之前无法进行篝火传送，无比艰苦的跑图过程，也让《365里路》这首歌深刻地印在了老ass们的心中。

黑暗之魂的地图相互联通且错综复杂，可以认为是一个 $n$ 个结点 $m$ 条边构成的有向图，结点编号为 $\{1,2,\cdots,n\}$，图上的每一个结点都是一个关卡。由于黑暗之魂的时空非常崩坏，所以这里的一周并不是 $7$ 天，而是 $d$ 天。每一个关卡 $i$ 在第 $j$ 天都会驻守 $w_{i,j}$ 的兵力，且每 $d$ 天为一个循环。初次到达王城的你看到巨大宝箱忍不住上前摸了摸，却因此不小心破坏了长公主的幻象，王城陷入了黑暗中，你也遭到了暗月骑士们的追击。已知亚诺尔隆德位于结点 $g$，为了躲避暗月骑士的追击，你于星期 $t$ 从亚诺尔隆德出发，你每天都**必须**通过一条有向边转移一个关卡，在第二天到达下一个关卡。

在每个关卡，你可以选择跑酷通过或者击杀全部敌人并通过，如果你在星期 $j$ 击杀第 $i$ 个关卡的所有敌人，那么你就能得到与驻守兵力 $w_{i,j}$ 相同的魂量。换句话说，你在 $i$ 号结点时，此时为星期 $j$，你可以选择不击杀敌人直接通过，也可以选择杀掉所有敌人获取魂量 $w_{i,j}$。如果你选择击杀某个关卡的敌人，那么该关卡就会失守，不会再有人驻守；即每一个关卡，你可以通过若干次，但是你只能在其中一次通过时选择击杀敌人。

你可以在有向图上游走无数次，你想知道你可能获得的最大魂量是多少。

## 输入格式

第一行输入三个整数 $n,m,d$，表示有向图的结点数、边数、每一周的天数。

第二行输入两个整数 $g,t$，表示亚诺尔隆德的位置和你从亚诺尔隆德启程的时间。

之后输入 $m$ 行，每一行两个整数 $u,v$，表示一条从结点 $u$ 到结点 $v$ 的有向边。数据保证每一个结点都有出度，且图中没有重边和自环。

接下来 $n$ 行，每行 $d$ 个整数，第 $i$ 行第 $j$ 个整数表示结点 $i$ 在星期 $j$ 驻守的兵力 $w_{i,j}$。

## 输出格式

输出一行一个整数，表示你于星期 $t$ 从结点 $g$ 出发能获得的最大魂量。

## 示例1

### 输入

```
4 4 2
2 1
1 2
3 4
2 3
4 1
3 0
1 2
1 2
2 1
```

### 输出 

```
5
```

### 说明

![](https://picture-1306543186.cos.ap-shanghai.myqcloud.com/example.png)

样例如图所示，图中共4个结点4条有向边，你于星期1从结点2出发。

第一天（星期1），在结点2击杀敌人，得到魂量 $1$；第二天（星期2）在结点3击杀敌人，得到魂量 $2$；第三天（星期1），在结点4击杀敌人，得到魂量 $1$；第四天（星期2），到达结点1，不击杀敌人直接通过；第五天（星期1），结点2已失守，只能直接通过；第六天（星期2），结点3已失守，只能直接通过……

在上述样例中，结点1只能在星期2到达，结点2只能在星期1到达，结点3只能在星期2到达，结点4只能在星期1到达，且每个结点至多只能击杀敌人一次，所以能获得的最大魂量为 $5$。

## 备注

$2\le n\le 100000$

$1\le m \le 300000$

$1\le u,v\le n$

$1\le d \le 20$

$1\le g\le n$

$1\le t\le d$

$0\le w_{i,j}\le 20000$